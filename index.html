<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #1a1a2e;
            color: #ffffff;
            overflow-x: hidden;
            transition: background-color 0.3s;
        }

        .container {
            max-width: 100%;
            padding: 20px 14px;
            margin: 0 auto;
        }

        .school-title {
            text-align: center;
            font-size: 24px;
            font-weight: 500;
            letter-spacing: 0.01em;
            margin-bottom: 20px;
            cursor: pointer;
            user-select: none;
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.2s;
        }

        .school-title:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            min-height: 150px;
        }

        .school-logo {
            max-width: 200px;
            max-height: 200px;
            cursor: pointer;
            transition: transform 0.2s;
            border-radius: 12px;
        }

        .school-logo:hover {
            transform: scale(1.05);
        }

        .clock-section {
            text-align: center;
            margin: 40px 0;
        }

        .time-display {
            font-size: 72px;
            font-weight: 500;
            color: #00d9ff;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            background: rgba(0, 0, 0, 0.4);
            padding: 20px 40px;
            border-radius: 132px;
            display: inline-block;
            margin-bottom: 10px;
        }

        .date-display {
            font-size: 18px;
            color: #e0e0e0;
            margin: 10px 0;
        }

        .current-event {
            font-size: 16px;
            font-weight: 600;
            color: #00ff88;
            margin: 10px 0;
        }

        .schedule-title {
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            display: inline-block;
            padding: 8px 16px;
            border-radius: 8px;
            transition: background-color 0.2s;
            user-select: none;
        }

        .schedule-title:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .schedule-container {
            overflow-x: auto;
            margin: 20px 0;
            padding: 10px 0;
            -webkit-overflow-scrolling: touch;
        }

        .schedule-container::-webkit-scrollbar {
            height: 8px;
        }

        .schedule-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .schedule-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        .schedule-row {
            display: flex;
            gap: 0;
            justify-content: center;
            min-width: max-content;
            padding: 0 20px;
        }

        .lesson-block {
            background: #3d5187;
            padding: 12px;
            min-width: 65px;
            text-align: center;
            font-size: 13px;
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 20px;
            margin: 0 1px;
        }

        .lesson-block:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .lesson-block.active {
            background: #049715;
            box-shadow: 0 0 20px rgba(4, 151, 21, 0.5);
        }

        .break-block {
            padding: 12px 8px;
            min-width: 24px;
            text-align: center;
            font-size: 13px;
            color: #ffffff;
        }

        .break-block.active {
            background: #a68f14;
            border-radius: 8px;
        }

        .marquee-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 28px;
            padding: 12px 20px;
            margin: 30px 0 20px 0;
            overflow: hidden;
            cursor: pointer;
        }

        .marquee-text {
            white-space: nowrap;
            animation: marquee 30s linear infinite;
            display: inline-block;
        }

        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .author {
            text-align: center;
            color: #808080;
            font-size: 14px;
            margin-top: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.2s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: #2a2a3e;
            margin: 5% auto;
            padding: 30px;
            border-radius: 16px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideIn 0.3s;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: #00d9ff;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #e0e0e0;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #3d5187;
            border-radius: 8px;
            background: #1a1a2e;
            color: #ffffff;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #00d9ff;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            flex: 1;
            min-width: 100px;
        }

        .btn-primary {
            background: #00d9ff;
            color: #1a1a2e;
        }

        .btn-primary:hover {
            background: #00b8e6;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #3d5187;
            color: #ffffff;
        }

        .btn-secondary:hover {
            background: #4d6197;
        }

        .btn-danger {
            background: #ff4444;
            color: #ffffff;
        }

        .btn-danger:hover {
            background: #cc0000;
        }

        .theme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .theme-option {
            padding: 16px;
            border: 2px solid #3d5187;
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            background: #1a1a2e;
        }

        .theme-option:hover {
            transform: translateY(-2px);
            border-color: #00d9ff;
        }

        .theme-option.selected {
            border-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }

        .week-schedule {
            margin-top: 20px;
        }

        .day-section {
            margin-bottom: 20px;
            padding: 15px;
            background: #16213e;
            border-radius: 12px;
        }

        .day-title {
            font-size: 16px;
            font-weight: 600;
            color: #00d9ff;
            margin-bottom: 10px;
        }

        .day-lessons {
            color: #e0e0e0;
            line-height: 1.8;
            white-space: pre-line;
        }

        @media (max-width: 768px) {
            .time-display {
                font-size: 48px;
                padding: 15px 30px;
            }

            .modal-content {
                margin: 10px;
                padding: 20px;
                max-width: calc(100% - 20px);
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }

        .settings-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #00d9ff;
            color: #1a1a2e;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 217, 255, 0.4);
            transition: all 0.2s;
            z-index: 100;
        }

        .settings-btn:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .hint-text {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="school-title" id="schoolTitle" onclick="editSchoolTitle()">–ù–∞–∑–≤–∞ –∑–∞–∫–ª–∞–¥—É</div>

        <div class="logo-container">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Crect fill='%2300d9ff' width='200' height='200' rx='20'/%3E%3Ctext x='100' y='120' font-size='80' text-anchor='middle' fill='%231a1a2e' font-family='sans-serif' font-weight='bold'%3Eüè´%3C/text%3E%3C/svg%3E" 
                 class="school-logo" 
                 id="schoolLogo" 
                 onclick="showLogoOptions()" 
                 alt="–õ–æ–≥–æ—Ç–∏–ø –∑–∞–∫–ª–∞–¥—É">
        </div>

        <div class="clock-section">
            <div class="time-display" id="timeDisplay">00:00</div>
            <div class="date-display" id="dateDisplay">01 –°—ñ—á–Ω—è 2025, –ü–æ–Ω–µ–¥—ñ–ª–æ–∫</div>
            <div class="current-event" id="currentEvent" onclick="editSilentMinute()">–£—Ä–æ–∫–∏ –Ω–µ —Ç—Ä–∏–≤–∞—é—Ç—å</div>
            <div class="schedule-title" onclick="showWeekSchedule()">üìö –†–æ–∑–∫–ª–∞–¥ —É—Ä–æ–∫—ñ–≤</div>
        </div>

        <div class="schedule-container" id="scheduleContainer">
            <div class="schedule-row" id="scheduleRow"></div>
        </div>

        <div class="marquee-container" onclick="editMarqueeUrl()">
            <div class="marquee-text" id="marqueeText">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...</div>
        </div>

        <div class="author">–†–æ–∑—Ä–æ–±–Ω–∏–∫ Obariv by Krasovskiy</div>
    </div>

    <button class="settings-btn" onclick="showSettings()">‚öôÔ∏è</button>

    <script>
        // –î–∞–Ω—ñ
        const themes = [
            {id: 'dark', name: 'üåô –¢–µ–º–Ω–∞', bg: '#1a1a2e', text: '#ffffff', time: '#0c78c9', lesson: '#112951', active: '#049715', breakActive: '#a68f14'},
            {id: 'light', name: '‚òÄÔ∏è –°–≤—ñ—Ç–ª–∞', bg: '#f5f5f5', text: '#1a1a1a', time: '#0066cc', lesson: '#e3f2fd', active: '#4caf50', breakActive: '#ff9800'},
            {id: 'blue', name: 'üíô –°–∏–Ω—è', bg: '#0d1b2a', text: '#e0e1dd', time: '#00b4d8', lesson: '#1b263b', active: '#0096c7', breakActive: '#90e0ef'},
            {id: 'purple', name: 'üíú –§—ñ–æ–ª–µ—Ç–æ–≤–∞', bg: '#2d1b3d', text: '#f0e6ff', time: '#c77dff', lesson: '#3d2952', active: '#9d4edd', breakActive: '#e0aaff'},
            {id: 'green', name: 'üíö –ó–µ–ª–µ–Ω–∞', bg: '#1b2a1f', text: '#e8f5e9', time: '#4caf50', lesson: '#2d4030', active: '#66bb6a', breakActive: '#81c784'},
            {id: 'red', name: '‚ù§Ô∏è –ß–µ—Ä–≤–æ–Ω–∞', bg: '#2a1215', text: '#ffebee', time: '#ef5350', lesson: '#3d1f23', active: '#f44336', breakActive: '#e57373'},
            {id: 'orange', name: 'üß° –ü–æ–º–∞—Ä–∞–Ω—á–µ–≤–∞', bg: '#2a1f0d', text: '#fff3e0', time: '#ff9800', lesson: '#3d2f1b', active: '#fb8c00', breakActive: '#ffb74d'},
            {id: 'pink', name: 'üíó –†–æ–∂–µ–≤–∞', bg: '#2a1520', text: '#fce4ec', time: '#ec407a', lesson: '#3d2130', active: '#e91e63', breakActive: '#f06292'},
            {id: 'teal', name: 'ü©µ –ë—ñ—Ä—é–∑–æ–≤–∞', bg: '#0d2a2a', text: '#e0f2f1', time: '#26a69a', lesson: '#1b3d3d', active: '#009688', breakActive: '#4db6ac'},
            {id: 'indigo', name: 'üí† –Ü–Ω–¥–∏–≥–æ', bg: '#1a1a3e', text: '#e8eaf6', time: '#5c6bc0', lesson: '#252552', active: '#3f51b5', breakActive: '#7986cb'}
        ];

        const daysOfWeek = ['–ü–æ–Ω–µ–¥—ñ–ª–æ–∫', '–í—ñ–≤—Ç–æ—Ä–æ–∫', '–°–µ—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä', "–ü'—è—Ç–Ω–∏—Ü—è", '–°—É–±–æ—Ç–∞', '–ù–µ–¥—ñ–ª—è'];
        
        let currentTheme = themes[0];
        let lessonTimes = {};
        let lessonsByDay = {};
        let silentMinute = {hour: 9, minute: 0};

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        function init() {
            loadFromStorage();
            initDefaultLessonTimes();
            renderSchedule();
            updateTime();
            setInterval(updateTime, 1000);
            setInterval(highlightCurrentEvent, 5000);
            applyTheme();
            loadMarqueeText();
            setInterval(loadMarqueeText, 2 * 60 * 1000);
        }

        function loadFromStorage() {
            const saved = localStorage.getItem('scheduleApp');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('schoolTitle').textContent = data.schoolTitle || '–ù–∞–∑–≤–∞ –∑–∞–∫–ª–∞–¥—É';
                if (data.theme) currentTheme = themes.find(t => t.id === data.theme) || themes[0];
                if (data.lessonTimes) lessonTimes = data.lessonTimes;
                if (data.lessonsByDay) lessonsByDay = data.lessonsByDay;
                if (data.silentMinute) silentMinute = data.silentMinute;
                if (data.marqueeUrl) document.getElementById('marqueeText').dataset.url = data.marqueeUrl;
                if (data.logo) document.getElementById('schoolLogo').src = data.logo;
            }
        }

        function saveToStorage() {
            const data = {
                schoolTitle: document.getElementById('schoolTitle').textContent,
                theme: currentTheme.id,
                lessonTimes,
                lessonsByDay,
                silentMinute,
                marqueeUrl: document.getElementById('marqueeText').dataset.url,
                logo: document.getElementById('schoolLogo').src
            };
            localStorage.setItem('scheduleApp', JSON.stringify(data));
        }

        function initDefaultLessonTimes() {
            if (Object.keys(lessonTimes).length === 0) {
                lessonTimes = {
                    1: {start: '09:00', end: '09:45'},
                    2: {start: '09:55', end: '10:40'},
                    3: {start: '11:00', end: '11:45'},
                    4: {start: '12:00', end: '12:45'},
                    5: {start: '13:00', end: '13:45'},
                    6: {start: '13:50', end: '14:35'},
                    7: {start: '14:40', end: '15:25'},
                    8: {start: '15:30', end: '16:15'}
                };
            }
            
            if (!lessonsByDay || Object.keys(lessonsByDay).length === 0) {
                lessonsByDay = {};
                for (let day = 1; day <= 7; day++) {
                    lessonsByDay[day] = {};
                }
            }
        }

        function renderSchedule() {
            const row = document.getElementById('scheduleRow');
            row.innerHTML = '';

            for (let i = 1; i <= 8; i++) {
                const time = lessonTimes[i];
                const lesson = document.createElement('div');
                lesson.className = 'lesson-block';
                lesson.dataset.lesson = i;
                lesson.onclick = () => editLesson(i);
                
                const currentDay = new Date().getDay();
                const day = currentDay === 0 ? 7 : currentDay;
                const className = lessonsByDay[day]?.[i] || '';
                
                lesson.innerHTML = `${i}<br>${time.start}<br>${time.end}${className ? '<br>' + className : ''}`;
                row.appendChild(lesson);

                if (i < 8) {
                    const breakBlock = document.createElement('div');
                    breakBlock.className = 'break-block';
                    const breakDuration = calculateBreakDuration(time.end, lessonTimes[i + 1].start);
                    breakBlock.innerHTML = `${breakDuration}<br>—Ö–≤`;
                    row.appendChild(breakBlock);
                }
            }
        }

        function calculateBreakDuration(endTime, startTime) {
            const [eh, em] = endTime.split(':').map(Number);
            const [sh, sm] = startTime.split(':').map(Number);
            return (sh * 60 + sm) - (eh * 60 + em);
        }

        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            document.getElementById('timeDisplay').textContent = `${hours}:${minutes}`;

            const options = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};
            const dateStr = now.toLocaleDateString('uk-UA', options);
            document.getElementById('dateDisplay').textContent = dateStr.charAt(0).toUpperCase() + dateStr.slice(1);

            highlightCurrentEvent();
        }

        function highlightCurrentEvent() {
            const now = new Date();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const currentMinutes = hour * 60 + minute;
            const currentDay = now.getDay() === 0 ? 7 : now.getDay();

            document.querySelectorAll('.lesson-block, .break-block').forEach(el => {
                el.classList.remove('active');
            });

            if (hour === silentMinute.hour && minute === silentMinute.minute) {
                document.getElementById('currentEvent').textContent = 'üïØÔ∏è –•–≤–∏–ª–∏–Ω–∞ –º–æ–≤—á–∞–Ω–Ω—è';
                document.getElementById('currentEvent').style.color = '#FFDD44';
                return;
            }

            for (let i = 1; i <= 8; i++) {
                const time = lessonTimes[i];
                const [sh, sm] = time.start.split(':').map(Number);
                const [eh, em] = time.end.split(':').map(Number);
                const startMin = sh * 60 + sm;
                const endMin = eh * 60 + em;

                if (currentMinutes >= startMin && currentMinutes < endMin) {
                    const lesson = document.querySelector(`[data-lesson="${i}"]`);
                    if (lesson) lesson.classList.add('active');
                    
                    const className = lessonsByDay[currentDay]?.[i] || '';
                    document.getElementById('currentEvent').textContent = className ? 
                        `${i} —É—Ä–æ–∫ ‚Ä¢ ${className}` : `–¢—Ä–∏–≤–∞—î ${i} —É—Ä–æ–∫`;
                    document.getElementById('currentEvent').style.color = currentTheme.active;
                    return;
                }

                if (i < 8) {
                    const nextTime = lessonTimes[i + 1];
                    const [nsh, nsm] = nextTime.start.split(':').map(Number);
                    const nextStartMin = nsh * 60 + nsm;

                    if (currentMinutes >= endMin && currentMinutes < nextStartMin) {
                        const breaks = document.querySelectorAll('.break-block');
                        if (breaks[i - 1]) breaks[i - 1].classList.add('active');
                        
                        document.getElementById('currentEvent').textContent = '–¢—Ä–∏–≤–∞—î –ø–µ—Ä–µ—Ä–≤–∞';
                        document.getElementById('currentEvent').style.color = currentTheme.breakActive;
                        return;
                    }
                }
            }

            document.getElementById('currentEvent').textContent = '–£—Ä–æ–∫–∏ –Ω–µ —Ç—Ä–∏–≤–∞—é—Ç—å';
            document.getElementById('currentEvent').style.color = currentTheme.active;
        }

        function applyTheme() {
            document.body.style.background = currentTheme.bg;
            document.body.style.color = currentTheme.text;
            document.getElementById('timeDisplay').style.color = currentTheme.time;
            document.querySelectorAll('.lesson-block').forEach(el => {
                if (!el.classList.contains('active')) {
                    el.style.background = currentTheme.lesson;
                }
            });
            saveToStorage();
        }

        function loadMarqueeText() {
            const url = document.getElementById('marqueeText').dataset.url || 'https://pastebin.com/raw/9hVaYuZE';
            fetch(url)
                .then(r => r.text())
                .then(text => {
                    document.getElementById('marqueeText').textContent = text;
                })
                .catch(() => {
                    document.getElementById('marqueeText').textContent = '‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è';
                });
        }

        // –ú–æ–¥–∞–ª—å–Ω—ñ –≤—ñ–∫–Ω–∞
        function showModal(title, content, buttons) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'block';
            
            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            
            modalContent.innerHTML = `<h2>${title}</h2>${content}`;
            
            const btnGroup = document.createElement('div');
            btnGroup.className = 'btn-group';
            buttons.forEach(btn => {
                const button = document.createElement('button');
                button.className = `btn ${btn.class || 'btn-secondary'}`;
                button.textContent = btn.text;
                button.onclick = () => {
                    if (btn.action) btn.action();
                    document.body.removeChild(modal);
                };
                btnGroup.appendChild(button);
            });
            
            modalContent.appendChild(btnGroup);
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            modal.onclick = (e) => {
                if (e.target === modal) document.body.removeChild(modal);
            };
        }

        function editSchoolTitle() {
            const current = document.getElementById('schoolTitle').textContent;
            showModal('üè´ –ù–∞–∑–≤–∞ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–ª–∞–¥—É', `
                <div class="form-group">
                    <label>–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∑–∞–∫–ª–∞–¥—É:</label>
                    <input type="text" id="newTitle" value="${current}" placeholder="–ù–∞–∑–≤–∞ –∑–∞–∫–ª–∞–¥—É">
                </div>
            `, [
                {text: '–ó–±–µ—Ä–µ–≥—Ç–∏', class: 'btn-primary', action: () => {
                    const newTitle = document.getElementById('newTitle').value.trim();
                    if (newTitle) {
                        document.getElementById('schoolTitle').textContent = newTitle;
                        saveToStorage();
                    }
                }},
                {text: '–°–∫–∞—Å—É–≤–∞—Ç–∏'}
            ]);
        }

        function showSettings() {
            showModal('‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è', `
                <div class="form-group">
                    <label>üé® –í–∏–±–µ—Ä—ñ—Ç—å —Ç–µ–º—É:</label>
                    <div class="theme-grid" id="themeGrid"></div>
                </div>
            `, [{text: '–ó–∞–∫—Ä–∏—Ç–∏', class: 'btn-primary'}]);
            
            const grid = document.getElementById('themeGrid');
            themes.forEach(theme => {
                const option = document.createElement('div');
                option.className = 'theme-option' + (theme.id === currentTheme.id ? ' selected' : '');
                option.textContent = theme.name;
                option.style.background = theme.bg;
                option.style.color = theme.text;
                option.onclick = () => {
                    currentTheme = theme;
                    applyTheme();
                    document.querySelectorAll('.theme-option').forEach(el => el.classList.remove('selected'));
                    option.classList.add('selected');
                };
                grid.appendChild(option);
            });
        }

        function editLesson(lessonNum) {
            const time = lessonTimes[lessonNum];
            const dayInputs = daysOfWeek.map((day, idx) => {
                const className = lessonsByDay[idx + 1]?.[lessonNum] || '';
                return `
                    <div class="form-group">
                        <label>${day}:</label>
                        <input type="text" id="day${idx + 1}" value="${className}" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 3–ê –Ü–ù–§." maxlength="10">
                    </div>
                `;
            }).join('');

            showModal(`–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —É—Ä–æ–∫ ${lessonNum}`, `
                <div class="form-group">
                    <label>‚è∞ –ß–∞—Å —É—Ä–æ–∫—É:</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <label style="font-size: 12px;">–ü–æ—á–∞—Ç–æ–∫:</label>
                            <input type="time" id="startTime" value="${time.start}">
                        </div>
                        <div>
                            <label style="font-size: 12px;">–ó–∞–∫—ñ–Ω—á–µ–Ω–Ω—è:</label>
                            <input type="time" id="endTime" value="${time.end}">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>üìö –ö–ª–∞—Å–∏ —ñ –ø—Ä–µ–¥–º–µ—Ç–∏ –ø–æ –¥–Ω—è—Ö —Ç–∏–∂–Ω—è:</label>
                    ${dayInputs}
                </div>
                <p class="hint-text">üí° –ó–∞–ª–∏—à—Ç–µ –ø–æ—Ä–æ–∂–Ω—ñ–º –¥–µ–Ω—å, —è–∫—â–æ –≤ —Ü–µ–π –¥–µ–Ω—å –Ω–µ–º–∞—î —É—Ä–æ–∫—É</p>
            `, [
                {text: '–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ', class: 'btn-danger', action: () => {
                    for (let day = 1; day <= 7; day++) {
                        delete lessonsByDay[day][lessonNum];
                    }
                    saveToStorage();
                    renderSchedule();
                }},
                {text: '–ó–±–µ—Ä–µ–≥—Ç–∏', class: 'btn-primary', action: () => {
                    lessonTimes[lessonNum] = {
                        start: document.getElementById('startTime').value,
                        end: document.getElementById('endTime').value
                    };
                    
                    for (let day = 1; day <= 7; day++) {
                        const className = document.getElementById(`day${day}`).value.trim();
                        if (className) {
                            if (!lessonsByDay[day]) lessonsByDay[day] = {};
                            lessonsByDay[day][lessonNum] = className;
                        } else {
                            if (lessonsByDay[day]) delete lessonsByDay[day][lessonNum];
                        }
                    }
                    
                    saveToStorage();
                    renderSchedule();
                }},
                {text: '–°–∫–∞—Å—É–≤–∞—Ç–∏'}
            ]);
        }

        function showWeekSchedule() {
            const now = new Date();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            const currentDay = now.getDay() === 0 ? 7 : now.getDay();

            const scheduleHtml = daysOfWeek.map((day, idx) => {
                const dayNum = idx + 1;
                let lessonsText = '';
                let hasLessons = false;

                for (let lesson = 1; lesson <= 8; lesson++) {
                    const className = lessonsByDay[dayNum]?.[lesson];
                    const time = lessonTimes[lesson];
                    
                    if (className && time) {
                        hasLessons = true;
                        const [sh, sm] = time.start.split(':').map(Number);
                        const [eh, em] = time.end.split(':').map(Number);
                        const startMin = sh * 60 + sm;
                        const endMin = eh * 60 + em;
                        
                        const isActive = (dayNum === currentDay) && (currentMinutes >= startMin && currentMinutes < endMin);
                        
                        lessonsText += `${isActive ? '‚úÖ ' : ''}${lesson}. ${time.start} - ${time.end} ‚Ä¢ ${className}${isActive ? ' üü¢' : ''}\n`;
                    }
                }
                
                if (!hasLessons) lessonsText = 'üî≠ –£—Ä–æ–∫—ñ–≤ –Ω–µ–º–∞—î';
                
                return `
                    <div class="day-section">
                        <div class="day-title">üîµ ${day.toUpperCase()}</div>
                        <div class="day-lessons">${lessonsText.trim()}</div>
                    </div>
                `;
            }).join('');

            showModal('üìö –†–û–ó–ö–õ–ê–î –ù–ê –¢–ò–ñ–î–ï–ù–¨', `
                <div class="week-schedule">${scheduleHtml}</div>
            `, [{text: '–ó–∞–∫—Ä–∏—Ç–∏', class: 'btn-primary'}]);
        }

        function editSilentMinute() {
            const current = `${String(silentMinute.hour).padStart(2, '0')}:${String(silentMinute.minute).padStart(2, '0')}`;
            
            showModal('üïØÔ∏è –•–≤–∏–ª–∏–Ω–∞ –º–æ–≤—á–∞–Ω–Ω—è', `
                <div class="form-group">
                    <label>–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —á–∞—Å —Ö–≤–∏–ª–∏–Ω–∏ –º–æ–≤—á–∞–Ω–Ω—è:</label>
                    <input type="time" id="silentTime" value="${current}">
                    <p class="hint-text">üí° –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —á–∞—Å –¥–ª—è —â–æ–¥–µ–Ω–Ω–æ—ó —Ö–≤–∏–ª–∏–Ω–∏ –º–æ–≤—á–∞–Ω–Ω—è</p>
                </div>
            `, [
                {text: '–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º', class: 'btn-secondary', action: () => {
                    silentMinute = {hour: 9, minute: 0};
                    saveToStorage();
                }},
                {text: '–ó–±–µ—Ä–µ–≥—Ç–∏', class: 'btn-primary', action: () => {
                    const timeValue = document.getElementById('silentTime').value;
                    const [h, m] = timeValue.split(':').map(Number);
                    silentMinute = {hour: h, minute: m};
                    saveToStorage();
                }},
                {text: '–°–∫–∞—Å—É–≤–∞—Ç–∏'}
            ]);
        }

        function editMarqueeUrl() {
            const current = document.getElementById('marqueeText').dataset.url || 'https://pastebin.com/raw/9hVaYuZE';
            
            showModal('üîó URL –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å', `
                <div class="form-group">
                    <label>–í–≤–µ–¥—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ —Ç–µ–∫—Å—Ç–æ–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</label>
                    <input type="url" id="marqueeUrl" value="${current}" placeholder="https://pastebin.com/raw/...">
                    <p class="hint-text">üí° –¢–µ–∫—Å—Ç –±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—å —Ç–∞ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏—Å—å –∫–æ–∂–Ω—ñ 2 —Ö–≤–∏–ª–∏–Ω–∏</p>
                </div>
            `, [
                {text: '–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º', class: 'btn-secondary', action: () => {
                    document.getElementById('marqueeText').dataset.url = 'https://pastebin.com/raw/9hVaYuZE';
                    loadMarqueeText();
                    saveToStorage();
                }},
                {text: '–ó–±–µ—Ä–µ–≥—Ç–∏', class: 'btn-primary', action: () => {
                    const url = document.getElementById('marqueeUrl').value.trim();
                    if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
                        document.getElementById('marqueeText').dataset.url = url;
                        loadMarqueeText();
                        saveToStorage();
                    } else {
                        alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è');
                    }
                }},
                {text: '–°–∫–∞—Å—É–≤–∞—Ç–∏'}
            ]);
        }

        function showLogoOptions() {
            showModal('üñºÔ∏è –õ–æ–≥–æ—Ç–∏–ø –∑–∞–∫–ª–∞–¥—É', `
                <div class="form-group">
                    <label>–û–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é:</label>
                </div>
            `, [
                {text: 'üñº –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è', class: 'btn-primary', action: () => {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = 'image/*';
                    input.onchange = (e) => {
                        const file = e.target.files[0];
                        if (file) {
                            const reader = new FileReader();
                            reader.onload = (event) => {
                                document.getElementById('schoolLogo').src = event.target.result;
                                saveToStorage();
                            };
                            reader.readAsDataURL(file);
                        }
                    };
                    input.click();
                }},
                {text: 'üîó –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–∞ URL', class: 'btn-primary', action: () => {
                    showModal('üîó URL –ª–æ–≥–æ—Ç–∏–ø—É', `
                        <div class="form-group">
                            <label>–í–≤–µ–¥—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:</label>
                            <input type="url" id="logoUrl" placeholder="https://example.com/logo.png">
                        </div>
                    `, [
                        {text: '–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏', class: 'btn-primary', action: () => {
                            const url = document.getElementById('logoUrl').value.trim();
                            if (url && (url.startsWith('http://') || url.startsWith('https://'))) {
                                document.getElementById('schoolLogo').src = url;
                                saveToStorage();
                            } else {
                                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è');
                            }
                        }},
                        {text: '–°–∫–∞—Å—É–≤–∞—Ç–∏'}
                    ]);
                }},
                {text: '‚Ü©Ô∏è –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º', class: 'btn-secondary', action: () => {
                    document.getElementById('schoolLogo').src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Crect fill='%2300d9ff' width='200' height='200' rx='20'/%3E%3Ctext x='100' y='120' font-size='80' text-anchor='middle' fill='%231a1a2e' font-family='sans-serif' font-weight='bold'%3Eüè´%3C/text%3E%3C/svg%3E";
                    saveToStorage();
                }},
                {text: '–°–∫–∞—Å—É–≤–∞—Ç–∏'}
            ]);
        }

        // –ó–∞–ø—É—Å–∫ –¥–æ–¥–∞—Ç–∫—É
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>